tôi là lập trình viên sử dụng python để làm tool hỗ trợ làm bảng kê nhanh hơn 

tôi có file theo dõi tạm như đính kèm "THEO DOI TAM UNG SONGLONG-MPF-CHINH NGUYEN 21.06.25" 

format ở từng sheet là như nhau chỉ khác nhau ở thông tin từng sheet (mỗi sheet đại diện cho thông tin 1 công ty), hiện tại chỉ quan tâm sheet "NOVA NHẬP" và "NOVA XUẤT" đại diện cho công ty Nova 

file này sẽ bao gồm tất cả thông tin THEO DÕI HÀNG HÓA TẠM ỨNG, THANH TOÁN, ĐIỀU XE của NOVA

và tôi sẽ dựa vào file này để lấy thông tin và điền vào file bảng kê chính, file "BẢNG KÊ CÔNG NỢ-STONE-T10.25" được đính kèm

mục tiêu của tôi là có 1 tool đơn giản có UI sử dụng PyQt5 
tool sẽ hỗ trợ lấy thông tin từ file theo dõi để điền tự động vào file bảng kê chính mà không làm thay đổi format file, font chữ, kiểu chữ hoặc bất cứ gì khác

tôi sẽ có 1 file mapping bằng file excel "mapping.xlsx" để dựa vào đó để lấy thông tin các cột cần lấy và điền thông tin, file sẽ bao gồm 2 sheet "Nova Xuất" để mapping cho phần xuất và "Nova Nhập" để mapping cho phần nhập
mỗi sheet sẽ có 2 cột chính, cột đầu (A) sẽ bao gồm thông tin các cột sẽ lấy dữ liệu ở file theo dõi và cột 2 sẽ bao gồm thông tin các cột cần điền thông tin ở file bảng kê)
file mapping như file mình gửi (nội dung mapping là các tên cột như A,B,C,...)

file mapping dành cho các cột chứa thông tin cố định, ngoài ra có một số thông tin của từng sheet sẽ cần xử lý thêm trước khi ghi vào file bảng kê như sau:
- sheet "NOVA NHẬP"
+ giá trị cột H mặc định file bảng kê là "KHO NOVA" 
+ cùng 1 hàng, cột O "Gross weight/cont (kg)", ô O = N / (K + L): lấy 2 chữ số thập phân ví dụ 27,101.75
+ các giá trị "SỐ CONT/SEAL" ở cột N file THEO DÕI sẽ được ghi vào "Số cont" ở cột I file Bảng Kê như sau:
ví dụ ở file THEO DÕI giá trị sẽ là 
'DRYU2688343
EGSU2175679
EGSU3172252
EITU0535536
khi ghi qua cột I file Bảng Kê thì mỗi SỐ CONT sẽ nằm ở 1 dòng (bạn cứ tạo dòng mới để ghi), như DRYU2688343 ở dòng I13, EGSU2175679 ở dòng I14, EGSU3172252 ở dòng I15 và EITU0535536 ở dòng I16, đồng thời cập nhật biến mergeNumber = 4 (do có 4 dòng SỐ CONT)
+ các giá trị "SỐ XE" ở cột P file THEO DÕI sẽ được ghi vào "Số xe" ở cột J file Bảng Kê như sau:
ví dụ ở file THEO DÕI giá trị sẽ là 
'51C23619
51C69298
51D41113
50H29647
khi ghi qua cột I file Bảng Kê thì mỗi SỐ CONT sẽ nằm ở 1 dòng (bạn cứ tạo dòng mới để ghi), như 51C23619 ở dòng J13, 51C69298 ở dòng J14, 51D41113 ở dòng J15 và 50H29647 ở dòng J16

- sheet "NOVA XUẤT"
+ giá trị cột G mặc định file bảng kê là "KHO NOVA" 
+ cùng 1 hàng, cột O "Gross weight/cont (kg)", ô O = N / (K + L + M): lấy 2 chữ số thập phân ví dụ  17,180.90 

còn tool vào sẽ cho:
- chọn file mapping
- chọn file theo dõi sau đó show các sheet có trong file theo dõi vào combobox (chỉ cho xem không cho chọn, mặc định tự tìm trong danh sách sheet và xử lý thông tin lần lượt 2 sheet theo thứ tự sheet "NOVA NHẬP" sau đó sheet "NOVA XUẤT") và thêm 1 combobox show 12 tháng để chọn tháng cần lấy thông tin trong 2 sheet (bạn có thể xem thông tin trong sheet "NOVA NHẬP" và "NOVA XUẤT" để xem cấu trúc tháng trong sheet như thế nào)
- chọn file bảng kê (fiel cần ghi dữ liệu)
- nút processing để khi bấm thì bắt đầu ghi dữ liệu vào bảng kê đã chọn 

lưu ý: 
+ xử lý và ghi dữ liệu vào bảng kê theo thứ tự từ trên xuống dưới, xuất trước nhập sau
+ nếu các ô ở file theo dõi không có dữ liệu thì không ghi dì ở file bảng kê
+ ở phần Nova Nhập sau khi xử lý dữ liệu xong các cột từ A tới H và các cột K, L, M, N, O ở file bảng kê sẽ được merge lại dựa theo Số cont ở cột I (giá trị biến mergeNumber): ví dụ cột I file Bảng Kê có 4 dòng số cont DRYU2688343 ở dòng I13, EGSU2175679 ở dòng I14, EGSU3172252 ở dòng I15 và EITU0535536 ở dòng I16, biến mergeNumber = 4 (do có 4 dòng SỐ CONT) thì các cột từ A tới H và các cột K, L, M, N, O sẽ được merge lại với nhua như merge A13 tới A16, B13 tới B16,...
+ sau khi ghi và xử lý đầy đủ dữ liệu ở đơn này (merge xong luôn) thì tiếp tục xuống dòng xử lý đơn tiếp theo, hết đơn ở nhập thì mới qua đơn của xuất

hãy giúp tôi code tool đó nhé, trước khi tiến hành code, tôi cần xác nhận bạn đã hiểu tất cả logic, đưa ra hướng bạn định giải quyết như thế nào cho tôi trước. sau khi tôi xác nhận bạn đã nắm rõ logic, mục tiêu của tool và hướng giải quyết hợp lý, tối ưu, tách file để dễ quản lý và mở rộng sau này, tôi nhắn Xác Nhận thì lúc đó bạn tiến hành làm


